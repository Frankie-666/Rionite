!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("cellx")):"function"==typeof define&&define.amd?define(["cellx"],t):"object"==typeof exports?exports.Rista=t(require("cellx")):e.Rista=t(e.cellx)}(this,function(e){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var r=n(1),o=r.EventEmitter,i=r.map,l=r.list,s=r.cellx,a=n(2),u=n(3),c=n(8),p=n(9),f=n(11),m=n(13),d=n(18),h=n(4),v=n(5),b=n(6),g=n(7),y=e.exports={EventEmitter:o,map:i,list:l,cellx:s,KeyedList:a,Attributes:u,Properties:c,Component:p,registerComponent:f,morphComponentElement:m,components:{RtContent:d},utils:{camelize:h,hyphenize:v,escapeHTML:b,unescapeHTML:g}};y.Rista=y},function(t,n){t.exports=e},function(e,t,n){"use strict";var r=n(1),o=r.ObservableList,i=o.prototype,l=i._registerValue,s=i._unregisterValue,a=i.get,u=i.set,c=i.setRange,p=i._addRange,f=i.insertRange,m=Object.create,d=o.extend({constructor:function(e,t){this._itemsByKey=m(null),this._keyName=t&&t.keyName||"id",o.call(this,e,t)},_registerValue:function(e){this._itemsByKey[e[this._keyName]]=e,l.call(this,e)},_unregisterValue:function(e){delete this._itemsByKey[e[this._keyName]],s.call(this,e)},_validateValues:function(e){for(var t=0,n=e.length;t<n;t++){var r=e[t];if(r!==Object(r))throw new TypeError("Value must be an object");if(this._itemsByKey[r[this._keyName]])throw new TypeError("Key of value must be unique")}},get:function(e){return"string"==typeof e?this._itemsByKey[e]:a.call(this,e)},set:function(e,t){return this._validateValues([t]),u.call(this,e,t)},setRange:function(e,t){return this._validateValues(t),c.call(this,e,t)},_addRange:function(e){this._validateValues(e),p.call(this,e)},insertRange:function(e,t){return this._validateValues(t),f.call(this,e,t)}});e.exports=d},function(e,t,n){"use strict";function r(e){return"[object RegExp]"==d.call(e)}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},i=n(1),l=i.EventEmitter,s=i.Cell,a=i.js.Map,u=n(4),c=n(5),p=n(6),f=n(7),m=Object.defineProperty,d=Object.prototype.toString,h=new a([[Boolean,[function(e){return null!==e&&"no"!=e},function(e){return e?"":null}]],["boolean",[function(e,t){return null!==e?"no"!=e:t},function(e,t){return e?"":t?"no":null}]],[Number,[function(e){return null!==e?+e:void 0},function(e){return void 0!==e?String(+e):null}]],["number",[function(e,t){return null!==e?+e:t},function(e){return void 0!==e?String(+e):null}]],[String,[function(e){return null!==e?e:void 0},function(e){return void 0!==e?String(e):null}]],["string",[function(e,t){return null!==e?e:t},function(e){return void 0!==e?String(e):null}]],[Object,[function(e,t,n){return null!==e?Object(Function("return "+f(e)+";").call(n)):null},function(e){return null!=e?p(r(e)?e.toString():JSON.stringify(e)):null}]],["object",[function(e,t,n){return null!==e?Object(Function("return "+f(e)+";").call(n)):t},function(e){return null!=e?p(r(e)?e.toString():JSON.stringify(e)):null}]]]),v=l.extend({Static:{typeHandlers:h},constructor:function(e){var t=this,n=e.element,r=e.constructor.elementAttributes,i=function(i){var l=r[i],a="undefined"==typeof l?"undefined":o(l),p=h.get("function"==a?l:a);if(!p)throw new TypeError("Unsupported attribute type");var f=u(i),d=c(i),v=t["_"+f]=t["_"+d]=new s(n.getAttribute(d),{merge:function(t,n){return n&&t===n[0]?n:[t,p[0](t,l,e)]},onChange:function(t){var n=t.oldValue[1],r=t.value[1];e.isReady&&(e.emit({type:"element-attribute-"+d+"-change",oldValue:n,value:r}),e.emit({type:"element-attribute-change",name:d,oldValue:n,value:r}),e.elementAttributeChanged&&e.elementAttributeChanged(d,n,r))}}),b={configurable:!0,enumerable:!0,get:function(){return v.get()[1]},set:function(e){e=p[1](e,l),null===e?n.removeAttribute(d):n.setAttribute(d,e),v.set(e)}};m(t,f,b),d!=f&&m(t,d,b)};for(var l in r)i(l)}});e.exports=v},function(e,t){"use strict";function n(e){return r[e]||(r[e]=e.replace(/[\-_]+([a-z]|$)/g,function(e,t){return t.toUpperCase()}))}var r=Object.create(null);e.exports=n},function(e,t){"use strict";function n(e){return r[e]||(r[e]=e.replace(/([A-Z])([^A-Z])/g,function(e,t,n){return"-"+t.toLowerCase()+n}).replace(/([A-Z]+)/g,function(e,t){return"-"+t.toLowerCase()}).replace("--","-").replace(/^-/,""))}var r=Object.create(null);e.exports=n},function(e,t){"use strict";function n(e){return e.replace(r,"&amp;").replace(o,"&lt;").replace(i,"&gt;").replace(l,"&quot;")}var r=/&/g,o=/</g,i=/>/g,l=/"/g;e.exports=n},function(e,t){"use strict";function n(e){return e.replace(r,"<").replace(o,">").replace(i,'"').replace(l,"&")}var r=/&lt;/g,o=/&gt;/g,i=/&quot;/g,l=/&amp;/g;e.exports=n},function(e,t,n){"use strict";var r=n(1),o=r.utils,i=o.createClass,l=o.defineObservableProperty,s=Object.create,a=i({constructor:function(e){return l(s(e.elementAttributes),"contentSourceElement",null)}});e.exports=a},function(e,t,n){"use strict";function r(e){var t=void 0,n=void 0,r=[];for(e instanceof Event?(t=e.target,n="rt-"+e.type):(t=e.target.element,n="rt-component-"+e.type);1==t.nodeType&&t.hasAttribute(n)&&r.unshift(t),t=t.parentNode,t;){var o=t.ristaComponent;if(o)for(var i=r.length;i;){var l=r[--i],s=o[l.getAttribute(n)];"function"==typeof s&&(s.call(o,e,l),r.splice(i,1))}}}function o(){var e=this.constructor.template;return e?e.render?e.render(this):e.call(this,this):""}var i=n(1),l=i.EventEmitter,s=i.Cell,a=i.utils,u=a.createClass,c=a.nextTick,p=n(10),f=n(11),m=n(3),d=n(8),h=n(13),v=n(17),b=n(4),g=Object.getPrototypeOf,y=Object.defineProperties,_=Object.prototype.hasOwnProperty,E=Array.isArray,C=Array.prototype.slice,S=/<(\w+(?:\-\w+)+)([^>]*)\/>/g,T=l.extend({Implements:[p],Static:{extend:function(e,t){return t.Extends=this,(t.Static||(t.Static={})).elementTagName=e,f(u(t))},elementTagName:void 0,elementAttributes:{},template:null},_parentComponent:null,get parentComponent(){if(void 0!==this._parentComponent)return this._parentComponent;for(var e;e=(e||this.element).parentNode;)if(e.ristaComponent)return this._parentComponent=e.ristaComponent;return this._parentComponent=null},ownerComponent:null,element:null,_elementAttributes:null,get elementAttributes(){return this._elementAttributes||(this._elementAttributes=new m(this))},_props:null,get props(){return this._props||(this._props=new d(this))},_elementInnerHTML:null,_prevAppliedElementInnerHTML:void 0,_elementAttached:null,initialized:!1,isReady:!1,_blockNameInMarkup:void 0,constructor:function x(e,t){l.call(this),p.call(this);var n=this.constructor;if(n.prototype==x.prototype)throw new TypeError("Component is abstract class");if(e||(e=document.createElement(n.elementTagName)),this.element=e,y(e,{ristaComponent:{value:this},$c:{value:this}}),(n.template||this.renderInner!==o)&&(this._elementInnerHTML=new s(function(){var e=this.renderInner();return(E(e)?e.join(""):e).replace(S,"<$1$2></$1>")},{owner:this})),this._elementAttached=new s((!1),{owner:this,onChange:this._onElementAttachedChange}),t){var r=this.props;for(var i in t)r[b(i)]=t[i]}this.created&&this.created()},_handleEvent:function(e){if(l.prototype._handleEvent.call(this,e),e.bubbles!==!1&&!e.isPropagationStopped){var t=this.parentComponent;t?t._handleEvent(e):r(e)}},_onElementInnerHTMLChange:function(){this.updateElement()},_onElementAttachedChange:function(e){var t=this,n=e.value;if(n&&!this.initialized&&(this.initialized=!0,this.initialize&&this.initialize()),this._elementInnerHTML&&this._elementInnerHTML[n?"on":"off"]("change",this._onElementInnerHTMLChange),n){if(this.updateElement(),!this.isReady){for(var r=this.element,o=this.constructor;r.className+=" "+o.elementTagName,o=g(o.prototype).constructor,o!=T;);for(var i=this.constructor.prototype;r.className+=" "+i.constructor.elementTagName,i=g(i),i!=T.prototype;);var l=this.elementAttributes,s=this.constructor.elementAttributes;for(var a in s)if("function"!=typeof s[a]){var u=b(a);l[u]=l[u]}r.className+=" _component-ready"}this.isReady&&!this.elementAttached||c(function(){t.isReady||(t.isReady=!0,t.ready&&t.ready()),t.elementAttached&&t.elementAttached()})}else this.dispose(),this.elementDetached&&this.elementDetached()},shouldElementUpdate:function(){return!!this._elementInnerHTML},renderInner:o,updateElement:function(){var e=this;if(!this._elementInnerHTML)return this;var t=this._elementInnerHTML.get();if(t==(this._prevAppliedElementInnerHTML||""))return this;var n=document.createElement("div");return n.innerHTML=t,h(this,n),this._prevAppliedElementInnerHTML=t,this.isReady&&c(function(){e.elementUpdated&&e.elementUpdated(),e.emit("element-update")}),this},$:function(e){return this.element.querySelector(this._prepareSelector(e))},$$:function(e){return C.call(this.element.querySelectorAll(this._prepareSelector(e)))},_prepareSelector:function(e){if(e=e.split("&"),1==e.length)return e[0];var t=this._blockNameInMarkup;if(!t){for(var n=this.constructor;;){if(_.call(n.prototype,"renderInner")){t=n.elementTagName;break}var r=g(n.prototype).constructor;if(n.template&&n.template!==r.template){t=n.elementTagName;break}if(r==T){t=this.constructor.elementTagName;break}n=r}this._blockNameInMarkup=t}return e.join("."+t)}});e.exports=T,document.addEventListener("DOMContentLoaded",function A(){document.removeEventListener("DOMContentLoaded",A),v.forEach(function(e){document.addEventListener(e,r)})})},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o=n(1),i=o.EventEmitter,l=o.utils.nextUID,s=Array.isArray,a=i.extend({constructor:function(){this._disposables={}},listenTo:function(e,t,n,o){var i=this,a=void 0;if(s(e)||e instanceof NodeList||e instanceof HTMLCollection||e.addClass&&e.each){"object"!=("undefined"==typeof t?"undefined":r(t))||s(t)?arguments.length<4&&(o=this):arguments.length<3&&(n=this),a=[];for(var u=0,c=e.length;u<c;u++)a.push(this.listenTo(e[u],t,n,o))}else if("object"==("undefined"==typeof t?"undefined":r(t)))if(a=[],s(t)){arguments.length<4&&(o=this);for(var p=t,f=0,m=p.length;f<m;f++)a.push(this.listenTo(e,p[f],n,o))}else{o=arguments.length<3?this:n;var d=t;for(var h in d)a.push(this.listenTo(e,h,d[h],o))}else{if(arguments.length<4&&(o=this),"object"!=("undefined"==typeof n?"undefined":r(n)))return this._listenTo(e,t,n,o);var v=n;if(a=[],s(v))for(var b=0,g=v.length;b<g;b++)a.push(this.listenTo(e,t,v[b],o));else for(var y in v)a.push(this.listenTo(e[y]("unwrap",0),t,v[y],o))}var _=l(),E=function(){for(var e=a.length;e;)a[--e].stop();delete i._disposables[_]},C=this._disposables[_]={stop:E,dispose:E};return C},_listenTo:function(e,t,n,r){var o=this;if(e instanceof i)e.on(t,n,r);else{if(!e.addEventListener)throw new TypeError("Unable to add a listener");e!==r&&(n=n.bind(r)),e.addEventListener(t,n)}var s=l(),a=function(){o._disposables[s]&&(e instanceof i?e.off(t,n,r):e.removeEventListener(t,n),delete o._disposables[s])},u=this._disposables[s]={stop:a,dispose:a};return u},setTimeout:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){var n=this,r=l(),o=setTimeout(function(){delete n._disposables[r],e.call(n)},t),i=function(){n._disposables[r]&&(clearTimeout(o),delete n._disposables[r])},s=this._disposables[r]={clear:i,dispose:i};return s}),setInterval:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){var n=this,r=l(),o=setInterval(function(){e.call(n)},t),i=function(){n._disposables[r]&&(clearInterval(o),delete n._disposables[r])},s=this._disposables[r]={clear:i,dispose:i};return s}),registerCallback:function(e){function t(){if(o._disposables[r])return delete o._disposables[r],e.apply(o,arguments)}var n=this,r=l(),o=this,i=function(){delete n._disposables[r]};return t.cancel=i,t.dispose=i,this._disposables[r]=t,t},dispose:function(){var e=this._disposables;for(var t in e)e[t].dispose();return this}});e.exports=a},function(e,t,n){"use strict";function r(e){var t=e.elementTagName;if(!t)throw new TypeError('"elementTagName" is required');var n=void 0;c.forEach(function(t){!u.call(e,t)&&u.call(n||(n=a(e.prototype).constructor),t)&&(e[t]=n[t])});var r=s(HTMLElement.prototype);return i(r,l),r._ristaComponentConstr=e,document.registerElement(t,{prototype:r}),e}var o=n(1),i=o.utils.mixin,l=n(12),s=Object.create,a=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty,c=["elementAttributes","template"];e.exports=r},function(e,t,n){"use strict";var r=n(1),o=r.utils.nextTick,i=Object.prototype.hasOwnProperty,l={get ristaComponent(){return new this._ristaComponentConstr(this)},get $c(){return this.ristaComponent},attachedCallback:function(){var e=this.ristaComponent;e._parentComponent=void 0,e.parentComponent?e._elementAttached.set(!0):o(function(){e._elementAttached.set(!0)})},detachedCallback:function(){var e=this.ristaComponent;e._parentComponent=null,e._elementAttached.set(!1)},attributeChangedCallback:function(e,t,n){var r=this.ristaComponent.elementAttributes,o="_"+e;i.call(r,o)&&r[o].set(n)}};e.exports=l},function(e,t,n){"use strict";function r(e,t,n){n||(n=e),l(e.element,t,{contentOnly:!0,getElementAttributes:function(e){return e[s]||e.attributes},onBeforeMorphElementContent:function(e,t){var r=e.ristaComponent;if(r&&(e[s]=t.attributes,r.ownerComponent=n,r.shouldElementUpdate()))return r.props.contentSourceElement=t,!1}})}var o=n(1),i=o.js.Symbol,l=n(14),s=i("prevAppliedAttributes");e.exports=r},function(e,t,n){"use strict";function r(e){return e.attributes}function o(e){return e.getAttribute("key")}function i(e,t){return e.tagName==t.tagName}function l(e,t,n){function l(e,t){var n=b(e);if(n){var r=x[n];r?(delete x[n],r.el.parentNode.replaceChild(e,r.el),f(e,r.toEl,!1)):(S[n]=T[n]=e,A=!0,t&&e.parentNode.removeChild(e))}else{t&&e.parentNode.removeChild(e);for(var o=e.firstElementChild;o;o=o.nextElementSibling)l(o,!1);E&&E(e)}}function c(e){for(var t=e.firstElementChild,n=void 0;t;t=n){n=t.nextElementSibling;var r=b(t);if(r){var o=x[r];o?(delete x[r],o.el.parentNode.replaceChild(t,o.el),f(t,o.toEl,!1)):(S[r]=T[r]=t,A=!0)}else c(t)}}function p(e){for(var t=e.firstElementChild;t;t=t.nextElementSibling)p(t);E&&E(e)}function f(e,t,n){if(!n){if(y&&y(e,t)===!1)return;if(a(e,t,v(e)),_&&_(e,t)===!1)return}var r=e.tagName;if("TEXTAREA"!=r){for(var o=e.firstChild,i=t.firstChild;i;i=i.nextSibling){var c=i.nodeType,p=void 0;if(1==c&&(p=b(i))){var m=S[p];if(m){delete S[p],delete T[p],o===m?o=o.nextSibling:e.insertBefore(m,o||null),f(m,i,!1);continue}}for(var d=!1,h=o;h;h=h.nextSibling)if(h.nodeType==c&&(1==c?b(h)===p&&(p||g(h,i))&&(d=!0,f(h,i,!1)):(d=!0,h.nodeValue=i.nodeValue)),d){o==h?o=o.nextSibling:e.insertBefore(h,o);break}if(!d)switch(c){case 1:var E=i.namespaceURI==u?document.createElement(i.tagName):document.createElementNS(i.namespaceURI,i.tagName);e.insertBefore(E,o||null),p?(x[p]={el:E,toEl:i},N=!0):f(E,i,!1);break;case 3:e.insertBefore(document.createTextNode(i.nodeValue),o||null);break;case 8:e.insertBefore(document.createComment(i.nodeValue),o||null);break;default:throw new TypeError("Unsupported node type")}}for(var h=void 0;o;o=h)h=o.nextSibling,1==o.nodeType?l(o,!0):e.removeChild(o)}var C=s[r];C&&C(e,t)}n||(n={});var m,d,h=!!n.contentOnly,v=n.getElementAttributes||r,b=n.getElementKey||o,g=n.isCompatibleElements||i,y=n.onBeforeMorphElement,_=n.onBeforeMorphElementContent,E=n.onElementRemoved,C=document.activeElement;void 0!==C.selectionStart&&(m=C.scrollLeft,d=C.scrollTop);var S=Object.create(null),T=Object.create(null),x=Object.create(null),A=!1,N=!1;for(f(e,t,h);N;){for(;A;){A=!1;for(var j in T){var w=T[j];delete T[j],c(w)}}N=!1;for(var j in x){var O=x[j];if(delete x[j],f(O.el,O.toEl,!1),N)break}}for(var j in S)p(S[j]);C!=document.activeElement&&(void 0!==m&&(C.scrollLeft=m,C.scrollTop=d),C.focus())}var s=n(15),a=n(16),u=document.documentElement.namespaceURI;e.exports=l},function(e,t){"use strict";var n={INPUT:function(e,t){e.value!=t.value&&(e.value=t.value),e.checked=t.checked},TEXTAREA:function(e,t){var n=t.value;e.value!=n&&(e.value=n),e.firstChild&&(e.firstChild.nodeValue=n)},OPTION:function(e,t){e.selected=t.selected}};e.exports=n},function(e,t){"use strict";function n(e,t,n){for(var r=t.attributes,o=0,i=r.length;o<i;o++){var l=r.item(o),s=l.namespaceURI,a=s?n.getNamedItemNS(s,l.name):n.getNamedItem(l.name);a&&a.value==l.value||(s?e.setAttributeNS(s,l.name,l.value):e.setAttribute(l.name,l.value))}for(var o=n.length;o;){var a=n.item(--o),u=a.namespaceURI;u?r.getNamedItemNS(u,a.name)||e.removeAttributeNS(u,a.name):r.getNamedItem(a.name)||e.removeAttribute(a.name)}}e.exports=n},function(e,t){"use strict";e.exports=["click","dblclick","mousedown","mouseup","input","change","submit","focusin","focusout"]},function(e,t,n){"use strict";var r=n(1),o=r.Cell,i=r.js.Symbol,l=r.utils.nextTick,s=n(9),a=n(13),u=i("contentSourceElement");e.exports=s.extend("rt-content",{shouldElementUpdate:function(){return!0},updateElement:function(){var e=this,t=this._contentSourceElement.get();return a(this,t,t==this.props.contentSourceElement?this.ownerComponent:this.ownerComponent.ownerComponent),this.isReady&&l(function(){e.emit("element-update")}),this},initialize:function(){var e=this.ownerComponent,t=e.props,n=this.element.getAttribute("select"),r=e[u]||(e[u]=new o(function(){return t.contentSourceElement.cloneNode(!0)}));this._contentSourceElement=new o(n?function(){var e=r.get().querySelectorAll(n);if(!e.length)return this.props.contentSourceElement;for(var t=document.createElement("div"),o=0,i=e.length;o<i;o++)t.appendChild(e[o]);return t}:function(){var e=r.get();if(!e.firstChild)return this.props.contentSourceElement;for(var t,n=document.createElement("div");t=e.firstChild;)n.appendChild(t);return n},{owner:this,onChange:this._onContentSourceElementChange}),this._contentSourceElementListening=!0},elementAttached:function(){this._contentSourceElementListening||this._contentSourceElement.on("change",this._onContentSourceElementChange)},elementDetached:function(){this._contentSourceElement.off("change",this._onContentSourceElementChange),this._contentSourceElementListening=!1},_onContentSourceElementChange:function(){this.updateElement()}})}])});