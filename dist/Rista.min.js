!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Rista=e():t.Rista=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var i=n(3),r=i.EventEmitter,s=i.map,o=i.list,l=i.cellx,a=n(15),u=t.exports={EventEmitter:r,map:s,list:o,cellx:l,Component:a};u.Rista=u},function(t,e,n){var i=n(8),r=Function("return this;")().Symbol;r||(r=function(t){return"__"+t+"_"+Math.floor(1e9*Math.random())+"_"+i()+"__"},r.iterator=r("iterator")),t.exports=r},function(t,e,n){var i=n(1),r=n(6),s=n(4),o=Object.prototype.hasOwnProperty,l=i("inner"),a=r({Static:{KEY_INNER:l},constructor:function(){this._events=Object.create(null)},on:function(t,e,n){if("object"==typeof t){n=arguments.length>=2?e:this;var i=t;for(t in i)o.call(i,t)&&this._on(t,i[t],n)}else this._on(t,e,arguments.length>=3?n:this);return this},off:function(t,e,n){var i=arguments.length;if(i)if("object"==typeof t){n=i>=2?e:this;var r=t;for(t in r)o.call(r,t)&&this._off(t,r[t],n)}else this._off(t,e,i>=3?n:this);else this._events&&(this._events=Object.create(null));return this},_on:function(t,e,n){var i=t.indexOf(":");if(-1!=i)this["_"+t.slice(i+1)]("on",t.slice(0,i),e,n);else{var r=(this._events||(this._events=Object.create(null)))[t];r||(r=this._events[t]=[]),r.push({listener:e,context:n})}},_off:function(t,e,n){var i=t.indexOf(":");if(-1!=i)this["_"+t.slice(i+1)]("off",t.slice(0,i),e,n);else{var r=this._events&&this._events[t];if(!r)return;for(var s=r.length;s;){var o=r[--s];if((o.listener==e||o.listener[l]===e)&&o.context===n){r.splice(s,1);break}}r.length||delete this._events[t]}},once:function(t,e,n){function i(){return this._off(t,i,n),e.apply(this,arguments)}return arguments.length<3&&(n=this),i[l]=e,this._on(t,i,n),this},emit:function(t){if("string"==typeof t)t={target:this,type:t};else if(t.target){if(t.target!=this)throw new TypeError("Event cannot be emitted on this object")}else t.target=this;return this._handleEvent(t),t},_handleEvent:function(t){var e=this._events&&this._events[t.type];if(e){e=e.slice();for(var n=0,i=e.length;i>n;n++)try{e[n].listener.call(e[n].context,t)===!1&&(t.isPropagationStopped=!0)}catch(r){this._logError(r)}}},_logError:function(){s.log.apply(s,arguments)}});t.exports=a},function(t,e,n){function i(t,e){function n(t){var s=this;s&&s!=I||(s=n),w.call(s,C)||Object.defineProperty(s,C,{value:new u});var o=s[C].get(n);if(!o){if("dispose"===t&&arguments.length>=2)return;e=Object.create(e),e.owner=s,o=new E(r,e),s[C].set(n,o)}switch(arguments.length){case 0:return o.get();case 1:return o.set(t),t;default:var l=t;switch(l){case"bind":return n=n.bind(s),n.constructor=i,n;case"unwrap":return o;default:var a=E.prototype[l].apply(o,j.call(arguments,1));return a===o?n:a}}}e||(e={});var r=t;return n.constructor=i,(e.onChange||e.onError)&&n.call(e.owner||I),n}function r(t,e){return new y(t,"boolean"==typeof e?{adoptsItemChanges:e}:e)}function s(t,e){return new b(t,"boolean"==typeof e?{adoptsItemChanges:e}:e)}function o(t,e,n){var r="_"+e;return t[r]="function"==typeof n&&n.constructor==i?n:i(n),Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:function(){return this[r]()},set:function(t){this[r](t)}}),t}function l(t,e){return Object.keys(e).forEach(function(n){o(t,n,e[n])}),t}function a(t,e,n){return 3==arguments.length?o(t,e,n):l(t,e),t}var u=n(5),h=n(1),c=n(24),f=n(8),v=n(12),d=n(6),p=n(13),_=n(11),g=n(4),m=n(2),y=n(23),b=n(22),E=n(21),x=_.UID,C=_.CELLS,w=Object.prototype.hasOwnProperty,j=Array.prototype.slice,I=Function("return this;")();g.setHandler(c),i.KEY_UID=x,i.ErrorLogger=g,i.EventEmitter=m,i.ObservableMap=y,i.ObservableList=b,i.Cell=E,i.map=r,i.list=s,i.define=a,i.js={Symbol:h,Map:u},i.utils={logError:c,nextUID:f,mixin:v,createClass:d,nextTick:p,defineObservableProperty:o,defineObservableProperties:l},i.cellx=i,t.exports=i},function(t,e){var n={_handler:null,setHandler:function(t){this._handler=t},log:function(){this._handler.apply(this,arguments)}};t.exports=n},function(t,e,n){var i=n(1),r=n(8),s=n(6),o=n(11),l=o.UID,a=Object.prototype.hasOwnProperty,u=Function("return this;")(),h=u.Map;if(!h){var c={value:void 0};h=s({constructor:function(t){if(this._entries=Object.create(null),this._objectStamps={},this._first=null,this._last=null,this.size=0,t)for(var e=0,n=t.length;n>e;e++)this.set(t[e][0],t[e][1])},has:function(t){return!!this._entries[this._getValueStamp(t)]},get:function(t){return(this._entries[this._getValueStamp(t)]||c).value},set:function(t,e){var n=this._entries,i=this._getValueStamp(t);if(n[i])n[i].value=e;else{var r=n[i]={key:t,keyStamp:i,value:e,prev:this._last,next:null};this.size++?this._last.next=r:this._first=r,this._last=r}return this},"delete":function(t){var e=this._getValueStamp(t),n=this._entries[e];if(!n)return!1;if(--this.size){var i=n.prev,r=n.next;i?i.next=r:this._first=r,r?r.prev=i:this._last=i}else this._first=null,this._last=null;return delete this._entries[e],delete this._objectStamps[e],!0},clear:function(){var t=this._entries;for(var e in t)delete t[e];this._objectStamps={},this._first=null,this._last=null,this.size=0},_getValueStamp:function(t){switch(typeof t){case"undefined":return"undefined";case"object":if(null===t)return"null";break;case"boolean":return"?"+t;case"number":return"+"+t;case"string":return","+t}return this._getObjectStamp(t)},_getObjectStamp:function(t){if(!a.call(t,l)){if(!Object.isExtensible(t)){var e,n=this._objectStamps;for(e in n)if(a.call(n,e)&&n[e]==t)return e;return e=r(),n[e]=t,e}Object.defineProperty(t,l,{value:r()})}return t[l]},forEach:function(t,e){e=arguments.length>=2?e:u;for(var n=this._first;n;){t.call(e,n.value,n.key,this);do n=n.next;while(n&&!this._entries[n.keyStamp])}},toString:function(){return"[object Map]"}}),[["keys",function(t){return t.key}],["values",function(t){return t.value}],["entries",function(t){return[t.key,t.value]}]].forEach(function(t){var e=t[1];h.prototype[t[0]]=function(){var t,n=this._entries,i=!1,r=this;return{next:function(){if(!i){if(t){do t=t.next;while(t&&!n[t.keyStamp])}else t=r._first;if(t)return{value:e(t),done:!1};i=!0}return{value:void 0,done:!0}}}}})}h.prototype[i.iterator]||(h.prototype[i.iterator]=h.prototype.entries),t.exports=h},function(t,e,n){function i(t){var e;t.Extends?(e=t.Extends,delete t.Extends):e=Object;var n;o.call(t,"constructor")?(n=t.constructor,delete t.constructor):n=e==Object?function(){}:function(){return e.apply(this,arguments)};var i=n.prototype=Object.create(e.prototype);return t.Implements&&(t.Implements.forEach(function(t){"function"==typeof t?(Object.keys(t).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}),s(i,t.prototype)):s(i,t)}),delete t.Implements),Object.keys(e).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}),t.Static&&(s(n,t.Static),delete t.Static),void 0===n.extend&&(n.extend=r),s(i,t),Object.defineProperty(i,"constructor",{configurable:!0,writable:!0,value:n}),n}var r,s=n(12),o=Object.prototype.hasOwnProperty;r=function(t){return t.Extends=this,i(t)},t.exports=i},function(t,e){var n=Object.is||function(t,e){return 0===t&&0===e?1/t==1/e:t===e||t!=t&&e!=e};t.exports=n},function(t,e){function n(){return String(++i)}var i=0;t.exports=n},function(t,e){"use strict";function n(t){return t.replace(/[\-_]+([a-z]|$)/g,function(t,e){return e.toUpperCase()})}t.exports=n},function(t,e,n){var i=n(5),r=n(2),s=r.extend({constructor:function(){this._valueCounts=new i},_onItemChange:function(t){this._handleEvent(t)},_registerValue:function(t){var e=this._valueCounts,n=e.get(t);n?e.set(t,n+1):(e.set(t,1),this.adoptsItemChanges&&t instanceof r&&t.on("change",this._onItemChange,this))},_unregisterValue:function(t){var e=this._valueCounts,n=e.get(t);n>1?e.set(t,n-1):(e["delete"](t),this.adoptsItemChanges&&t instanceof r&&t.off("change",this._onItemChange,this))}});t.exports=s},function(t,e,n){var i=n(1),r={UID:i("uid"),CELLS:i("cells")};t.exports=r},function(t,e){function n(t,e){for(var n=Object.getOwnPropertyNames(e),i=0,r=n.length;r>i;i++){var s=n[i];Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(e,s))}return t}t.exports=n},function(t,e,n){var i,r=n(4),s=Function("return this;")();if(s.process&&"[object process]"==process.toString()&&process.nextTick)i=process.nextTick;else if(s.setImmediate)i=function(t){setImmediate(t)};else if(s.Promise&&-1!=Promise.toString().indexOf("[native code]")){var o=Promise.resolve();i=function(t){o.then(function(){t()})}}else{var l;s.addEventListener("message",function(){if(l){var t=l;l=null;for(var e=0,n=t.length;n>e;e++)try{t[e]()}catch(i){r.log(i)}}}),i=function(t){l?l.push(t):(l=[t],postMessage("__tic__","*"))}}t.exports=i},function(t,e,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},r=n(3),s=r.EventEmitter,o=r.Cell,l=r.js.Map,a=n(9),u=n(19),h=n(18),c=n(20),f=new l([[Boolean,[function(t){return null!=t?"no"!=t:!1},function(t){return t?"":void 0}]],["boolean",[function(t,e){return null!=t?"no"!=t:e},function(t,e){return t?"":e?"no":void 0}]],[Number,[function(t){return null!=t?+t:void 0},function(t){return void 0!==t?String(+t):void 0}]],["number",[function(t,e){return null!=t?+t:e},function(t){return void 0!==t?String(+t):void 0}]],[String,[function(t){return null!=t?t:void 0},function(t){return void 0!==t?String(t):void 0}]],["string",[function(t,e){return null!=t?t:e},function(t){return void 0!==t?String(t):void 0}]],[Object,[function(t){return null!=t?Object(Function("return "+c(t)+";")()):null},function(t){return null!=t?h(JSON.stringify(t)):void 0}]],["object",[function(t,e){return null!=t?Object(Function("return "+c(t)+";")()):e},function(t){return null!=t?h(JSON.stringify(t)):void 0}]]]),v=s.extend({Static:{typeHandlers:f},constructor:function(t){var e=this,n=t.element,r=t.constructor.elementAttributes,s=function(t){var s=r[t],l="undefined"==typeof s?"undefined":i(s),h=f.get("function"==l?s:l);if(!h)throw new TypeError("Unsupported attribute type");var c=a(t),v=u(c),d="_"+v,p=e[d]=new o(n.getAttribute(v),{merge:function(t){return h[0](t,s)}}),_={configurable:!0,enumerable:!0,get:function(){return p.get()},set:function(t){t=h[1](t,s),void 0===t?n.removeAttribute(v):n.setAttribute(v,t)}};Object.defineProperty(e,c,_),v!=c&&Object.defineProperty(e,v,_)};for(var l in r)s(l)}});t.exports=v},function(t,e,n){"use strict";function i(t){for(var e=t instanceof Event?t.target:t.target.element,n="rt-"+t.type,i=[];1==e.nodeType&&e.hasAttribute(n)&&i.unshift(e),e=e.parentNode,e;){var r=e.ristaComponent;if(r)for(var s=i.length;s;){var o=i[--s],l=r[o.getAttribute(n)];"function"==typeof l&&(l.call(r,t,o),i.splice(s,1))}}}function r(){var t=this.template;return t?t.render?t.render(this):t.call(this,this):""}var s=n(3),o=s.EventEmitter,l=s.Cell,a=s.js.Symbol,u=s.utils,h=u.mixin,c=u.createClass,f=n(25),v=n(9),d=n(16),p=n(14),_=n(17),g=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty,y=Array.isArray,b=a("lastAppliedAttributes"),E=null,x=null,C={ristaComponent:null,createdCallback:function(){x?this.ristaComponent=x:(E=this,this.ristaComponent=new this._ristaComponentConstr,E=null)},attachedCallback:function(){this.ristaComponent._elementAttached.set(!0)},detachedCallback:function(){this.ristaComponent._elementAttached.set(!1)},attributeChangedCallback:function(t,e,n){var i=this.ristaComponent,r=i.elementAttributes,s="_"+t;if(m.call(r,s)){var o=r[s],l=o.get();if(o.set(n),i.isReady){var a=o.get();i.emit({type:"element-attribute-"+t+"-change",oldValue:l,value:a}),i.emit({type:"element-attribute-change",name:t,oldValue:l,value:a}),i.elementAttributeChanged&&i.elementAttributeChanged(t,l,a)}}}},w=o.extend({Implements:[d],Static:{extend:function(t,e){e.Extends=this,e.elementTagName=t;var n=c(e),i=Object.create(HTMLElement.prototype);return h(i,C),i._ristaComponentConstr=n,document.registerElement(t,{prototype:i}),n},elementAttributes:{}},element:null,elementTagName:void 0,_elementAttributes:null,get elementAttributes(){return this._elementAttributes||(this._elementAttributes=new p(this))},_props:null,get props(){return this._props||(this._props=new _(this))},_elementInnerHTML:null,_lastAppliedElementInnerHTML:void 0,_elementAttached:null,initialized:!1,isReady:!1,template:null,constructor:function j(t){d.call(this);var e=j.prototype,n=this.constructor.prototype;if(n==e)throw new TypeError("Component is abstract class");var i=void 0;E?i=this.element=E:(x=this,i=this.element=document.createElement(this.elementTagName),x=null),(this.template||this.renderInner!==r)&&(this._elementInnerHTML=new l(function(){var t=this.renderInner();return y(t)?t.join(""):t},{owner:this})),this._elementAttached=new l(!1,{owner:this,onChange:this._onElementAttachedChange});for(var s=n;i.className+=" "+s.elementTagName,s=g(s),s!=e;);if(t){var o=this.elementAttributes;for(var a in t)o[v(a)]=t[a]}this.created&&this.created()},_handleEvent:function(t){if(o.prototype._handleEvent.call(this,t),t.bubbles!==!1&&!t.isPropagationStopped){var e=this.getParent();e?e._handleEvent(t):i(t)}},getParent:function(){for(var t;t=(t||this.element).parentNode;)if(t.ristaComponent)return t.ristaComponent;return null},_onElementInnerHTMLChange:function(){this.update()},_onElementAttachedChange:function(t){var e=t.value;if(e&&!this.initialized&&(this.initialized=!0,this.initialize&&this.initialize()),this._elementInnerHTML&&this._elementInnerHTML[e?"on":"off"]("change",this._onElementInnerHTMLChange),e){if(this.update(),!this.isReady){this.isReady=!0;var n=this.constructor.elementAttributes,i=this.elementAttributes;for(var r in n)if("function"!=typeof n[r]){var s=v(r);i[s]=i[s]}this.ready&&this.ready()}this.elementAttached&&this.elementAttached()}else this.dispose(),this.elementDetached&&this.elementDetached()},renderInner:r,update:function(){if(!this._elementInnerHTML)return this;var t=this._elementInnerHTML.get();if(t==(this._lastAppliedElementInnerHTML||""))return this;var e=document.createElement("div");return e.innerHTML=t,f(this.element,e,{contentOnly:!0,getElementAttributes:function(t){return t[b]||t.attributes},getElementKey:function(t){return t.getAttribute("key")},onBeforeMorphElementContent:function(t,e){var n=t.ristaComponent;return n&&(t[b]=e.attributes,n.template||n.renderInner!==r)?(n.props.contentSourceElement=e,!1):void 0}}),this._lastAppliedElementInnerHTML=t,this},$:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){return t=t.split("&").join("."+this.elementTagName),"function"==typeof $&&$.fn?$(this.element).find(t):this.element.querySelectorAll(t)})});t.exports=w},function(t,e,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},r=n(3),s=r.EventEmitter,o=r.utils.nextUID,l=Array.isArray,a=s.extend({constructor:function(){s.call(this),this._disposables={}},listenTo:function(t,e,n,r){var s=this,a=void 0;if(l(t)||t instanceof NodeList||t instanceof HTMLCollection||t.addClass&&t.each){"object"!=("undefined"==typeof e?"undefined":i(e))||l(e)?arguments.length<4&&(r=this):arguments.length<3&&(n=this),a=[];for(var u=0,h=t.length;h>u;u++)a.push(this.listenTo(t[u],e,n,r))}else if("object"==("undefined"==typeof e?"undefined":i(e)))if(a=[],l(e)){arguments.length<4&&(r=this);for(var c=e,f=0,v=c.length;v>f;f++)a.push(this.listenTo(t,c[f],n,r))}else{r=arguments.length<3?this:n;var d=e;for(var p in d)a.push(this.listenTo(t,p,d[p],r))}else{if(arguments.length<4&&(r=this),"object"!=("undefined"==typeof n?"undefined":i(n)))return this._listenTo(t,e,n,r);var _=n;if(a=[],l(_))for(var g=0,m=_.length;m>g;g++)a.push(this.listenTo(t,e,_[g],r));else for(var y in _)a.push(this.listenTo(t[y]("unwrap",0),e,_[y],r))}var b=o(),E=function(){for(var t=a.length;t;)a[--t].stop();delete s._disposables[b]},x=this._disposables[b]={stop:E,dispose:E};return x},_listenTo:function(t,e,n,i){var r=this;if(t instanceof s)t.on(e,n,i);else{if(!t.addEventListener)throw new TypeError("Unable to add a listener");t!==i&&(n=n.bind(i)),t.addEventListener(e,n)}var l=o(),a=function(){r._disposables[l]&&(t instanceof s?t.off(e,n,i):t.removeEventListener(e,n),delete r._disposables[l])},u=this._disposables[l]={stop:a,dispose:a};return u},setTimeout:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t,e){var n=this,i=o(),r=setTimeout(function(){delete n._disposables[i],t.call(n)},e),s=function(){n._disposables[i]&&(clearTimeout(r),delete n._disposables[i])},l=this._disposables[i]={clear:s,dispose:s};return l}),setInterval:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t,e){var n=this,i=o(),r=setInterval(function(){t.call(n)},e),s=function(){n._disposables[i]&&(clearInterval(r),delete n._disposables[i])},l=this._disposables[i]={clear:s,dispose:s};return l}),registerCallback:function(t){function e(){return r._disposables[i]?(delete r._disposables[i],t.apply(r,arguments)):void 0}var n=this,i=o(),r=this,s=function(){delete n._disposables[i]};return e.cancel=s,e.dispose=s,this._disposables[i]=e,e},dispose:function(){var t=this._disposables;for(var e in t)t[e].dispose();return this}});t.exports=a},function(t,e,n){"use strict";var i=n(3),r=i.Cell,s=i.utils.createClass,o=s({constructor:function(t){var e=new r(t.element.childNodes,{merge:function(t){if("string"==typeof t){var e=t;return t=document.createElement("div"),t.innerHTML=e,t}return t}});return Object.create(t.elementAttributes,{contentSourceElement:{configurable:!0,enumerable:!0,get:function(){return e.get()},set:function(t){e.set(t)}}})}});t.exports=o},function(t,e){"use strict";function n(t){return t.replace(i,"&amp;").replace(r,"&lt;").replace(s,"&gt;").replace(o,"&quot;")}var i=/&/g,r=/</g,s=/>/g,o=/"/g;t.exports=n},function(t,e){"use strict";function n(t){return t.replace(/([A-Z])([^A-Z])/g,function(t,e,n){return"-"+e.toLowerCase()+n}).replace(/([A-Z]+)/g,function(t,e){return"-"+e.toLowerCase()}).replace("--","-").replace(/^-/,"")}t.exports=n},function(t,e){"use strict";function n(t){return t.replace(i,"<").replace(r,">").replace(s,'"').replace(o,"&")}var i=/&lt;/g,r=/&gt;/g,s=/&quot;/g,o=/&amp;/g;t.exports=n},function(t,e,n){function i(){if(p){p=!1,_=!0;for(var t=f[v];;){var e=(t||[]).shift();if(e){var n=v,i=e._level,r=e._changeEvent;if(!r){if(i>v||-1==e._levelInRelease){if(!t.length){if(++v>d)break;t=f[v]}continue}if(e.pull(),i=e._level,r=e._changeEvent,v!=n){r?t.unshift(e):n>=i&&(e._levelInRelease=-1),t=f[v];continue}if(i>v){t.length||(t=f[++v]);continue}}if(e._levelInRelease=-1,r){e._fixedValue=e._value,e._changeEvent=null,e._events.change&&e._handleEvent(r);for(var s=e._pushingIndex,o=e._slaves,l=0,a=o.length;a>l;l++){var h=o[l];h._level<=i&&(h._level=i+1),s>h._pushingIndex&&(h._pushingIndex=s,h._changeEvent=null,h._addToRelease())}}if(v==n){if(t.length)continue;if(++v>d)break}t=f[v]}else t=f[++v]}v=u,d=-1,_=!1,g++}}function r(t,e){e(t)}var s=n(7),o=n(13),l=n(2),a=Array.prototype.slice,u=Number.MAX_SAFE_INTEGER||9007199254740991,h=l.KEY_INNER,c=0,f=[],v=u,d=-1,p=!1,_=!1,g=1,m=null,y={original:null},b=l.extend({constructor:function(t,e){l.call(this),e||(e={});var n=this;this.debugKey=e.debugKey,this.owner=e.owner||this,this._pull="function"==typeof t?t:null,this._get=e.get||null,this._validate=e.validate||null,this._merge=e.merge||null,this._put=e.put||r;var i=this.push,s=this.fail;this.push=function(t){i.call(n,t)},this.fail=function(t){s.call(n,t)},this._onFulfilled=this._onRejected=null,this._reap=e.reap||null,this._pull?this._fixedValue=this._value=void 0:(this._validate&&this._validate(t,void 0),this._merge&&(t=this._merge(t,void 0)),this._fixedValue=this._value=t,t instanceof l&&t.on("change",this._onValueChange,this)),this._error=null,this._errorCell=null,this._pushingIndex=0,this._version=0,this._inited=!1,this._currentlyPulls=!1,this._active=!1,this._hasFollowers=!1,this._masters=null,this._slaves=[],this._level=0,this._levelInRelease=-1,this._pending=this._fulfilled=this._rejected=!1,this._changeEvent=null,this._canCancelChange=!0,this._lastErrorEvent=null,e.onChange&&this.on("change",e.onChange),e.onError&&this.on("error",e.onError)},on:function(t,e,n){return p&&i(),this._activate(),"object"==typeof t?l.prototype.on.call(this,t,arguments.length>=2?e:this.owner):l.prototype.on.call(this,t,e,arguments.length>=3?n:this.owner),this._hasFollowers=!0,this},off:function(t,e,n){p&&i();var r=arguments.length;return r?"object"==typeof t?l.prototype.off.call(this,t,r>=2?e:this.owner):l.prototype.off.call(this,t,e,r>=3?n:this.owner):l.prototype.off.call(this),this._slaves.length||this._events.change||this._events.error||(this._hasFollowers=!1,this._deactivate()),this},addChangeListener:function(t,e){return this.on("change",t,arguments.length>=2?e:this.owner)},removeChangeListener:function(t,e){return this.off("change",t,arguments.length>=2?e:this.owner)},addErrorListener:function(t,e){return this.on("error",t,arguments.length>=2?e:this.owner)},removeErrorListener:function(t,e){return this.off("error",t,arguments.length>=2?e:this.owner)},subscribe:function(t,e){function n(e){return t.call(this,e.error||null,e)}return n[h]=t,arguments.length<2&&(e=this.owner),this.on("change",n,e).on("error",n,e)},unsubscribe:function(t,e){return arguments.length<2&&(e=this.owner),this.off("change",t,e).off("error",t,e)},_registerSlave:function(t){this._activate(),this._slaves.push(t),this._hasFollowers=!0},_unregisterSlave:function(t){this._slaves.splice(this._slaves.indexOf(t),1),this._slaves.length||this._events.change||this._events.error||(this._hasFollowers=!1,this._deactivate())},_activate:function(){if(this._pull&&!this._active&&(!this._inited||this._masters)){if(this._version<g){var t=this._tryPull();t===y?this._fail(y.original,!0):this._push(t,!0)}var e=this._masters;if(e){for(var n=e.length;n;)e[--n]._registerSlave(this);this._active=!0}}},_deactivate:function(){if(this._active){for(var t=this._masters,e=t.length;e;)t[--e]._unregisterSlave(this);this._active=!1,this._reap&&this._reap.call(this.owner)}},_addToRelease:function(){var t=this._level;t<=this._levelInRelease||((f[t]||(f[t]=[])).push(this),v>t&&(v=t),t>d&&(d=t),this._levelInRelease=t,p||_||(p=!0,o(i)))},_onValueChange:function(t){this._changeEvent?(t.prev=this._changeEvent,this._changeEvent=t,this._value===this._fixedValue&&(this._canCancelChange=!1)):(t.prev=null,this._changeEvent=t,this._canCancelChange=!1,this._addToRelease())},pull:function(){if(!this._pull)return this;p&&i();var t,e,n=this._hasFollowers;n&&(t=this._masters||[],e=this._level),this._pending=!0,this._fulfilled=this._rejected=!1;var r=this._tryPull();if(n){for(var s=this._masters||[],o=s.length,l=0,a=o;a;){var u=s[--a];-1==t.indexOf(u)&&(u._registerSlave(this),l++)}if(o-l<t.length)for(var h=t.length;h;){var c=t[--h];-1==s.indexOf(c)&&c._unregisterSlave(this)}if(this._active=!!o,_&&this._level>e)return this._addToRelease(),this}return r===y?this._fail(y.original,!0):this._push(r,!0),this},_tryPull:function(){if(this._currentlyPulls)throw new TypeError("Circular pulling detected");var t=m;m=this,this._currentlyPulls=!0,this._masters=null,this._level=0;try{return this._pull.call(this.owner,this.push,this.fail,this._value)}catch(e){return y.original=e,y}finally{m=t,this._version=g+_,this._inited=!0,this._currentlyPulls=!1}},get:function(){if(p&&this._pull&&i(),this._pull&&!this._active&&this._version<g&&(!this._inited||this._masters)){var t=this._tryPull();if(this._hasFollowers){var e=this._masters;if(e){for(var n=e.length;n;)e[--n]._registerSlave(this);this._active=!0}}t===y?this._fail(y.original,!0):this._push(t,!0)}if(m){var r=m._masters,s=this._level;r?-1==r.indexOf(this)&&(r.push(this),m._level<=s&&(m._level=s+1)):(m._masters=[this],m._level=s+1)}return this._get?this._get(this._value):this._value},set:function(t){var e=this._value;return this._validate&&this._validate(t,e),this._merge&&(t=this._merge(t,e)),this._put.call(this.owner,t,this.push,this.fail,e),this},push:function(t){return this._push(t,!1),this},_push:function(t,e){this._setError(null),e||(this._pushingIndex=++c);var n=this._value;s(t,n)||(this._value=t,n instanceof l&&n.off("change",this._onValueChange,this),t instanceof l&&t.on("change",this._onValueChange,this),this._hasFollowers?this._changeEvent?s(t,this._fixedValue)&&this._canCancelChange?(this._levelInRelease=-1,this._changeEvent=null):this._changeEvent={target:this,type:"change",oldValue:n,value:t,prev:this._changeEvent}:(this._changeEvent={target:this,type:"change",oldValue:n,value:t,prev:null},this._canCancelChange=!0,this._addToRelease()):(_||e||g++,this._fixedValue=t),!e&&this._pending&&(this._pending=!1,this._fulfilled=!0,this._onFulfilled&&this._onFulfilled(t)))},fail:function(t){return this._fail(t,!1),this},_fail:function(t,e){this._logError(t),t instanceof Error||(t=new Error(String(t))),!e&&this._pending&&(this._pending=!1,this._rejected=!0,this._onRejected&&this._onRejected(t)),this._handleErrorEvent({type:"error",error:t})},_handleErrorEvent:function(t){if(this._lastErrorEvent!==t){this._setError(t.error),this._lastErrorEvent=t,this._handleEvent(t);for(var e=this._slaves,n=0,i=e.length;i>n;n++)e[n]._handleErrorEvent(t)}},getError:function(){return(this._errorCell||(this._errorCell=new b(this._error))).get()},_setError:function(t){if(this._error!==t&&(this._error=t,this._errorCell&&this._errorCell.set(t),!t))for(var e=this._slaves,n=0,i=e.length;i>n;n++)e[n]._setError(t)},then:function(t,e){if(p&&i(),this._fulfilled)return Promise.resolve(this._get?this._get(this._value):this._value).then(t);if(this._rejected)return Promise.reject(this._error)["catch"](e);var n=this,r=new Promise(function(t,e){n._onFulfilled=function(e){n._onFulfilled=n._onRejected=null,t(n._get?n._get(e):e)},n._onRejected=function(t){n._onFulfilled=n._onRejected=null,e(t)}}).then(t,e);return this._pending||this.pull(),r},"catch":function(t){return this.then(null,t)},_logError:function(){var t=a.call(arguments);this.debugKey&&t.unshift("["+this.debugKey+"]"),l.prototype._logError.apply(this,t)},dispose:function(){return p&&i(),this._dispose(),this},_dispose:function(){for(var t=this._slaves,e=0,n=t.length;n>e;e++)t[e]._dispose();this.off()}});t.exports=b},function(t,e,n){function i(t,e){return e>t?-1:t>e?1:0}function r(t,e){var n=t._items;if(t.sorted)for(var i=t.comparator,r=0,s=e.length;s>r;r++){for(var o=e[r],l=0,a=n.length;l!=a;){var h=l+a>>1;i(o,n[h])<0?a=h:l=h+1}n.splice(l,0,o),t._registerValue(o)}else{u.apply(n,e);for(var c=e.length;c;)t._registerValue(e[--c])}t.length=n.length}var s=n(1),o=n(7),l=n(2),a=n(10),u=Array.prototype.push,h=Array.prototype.splice,c=Function("return this;")(),f=l.extend({Implements:[a],constructor:function v(t,e){l.call(this),a.call(this),e||(e={}),this._items=[],this.length=0,this.adoptsItemChanges=e.adoptsItemChanges!==!1,this.comparator=null,this.sorted=!1,(e.sorted||e.comparator&&e.sorted!==!1)&&(this.comparator=e.comparator||i,this.sorted=!0),t&&r(this,t instanceof v?t._items:t)},_validateIndex:function(t,e){if(void 0===t)return t;if(0>t){if(t+=this.length,0>t)throw new RangeError("Index out of valid range")}else if(t>=this.length+(e?1:0))throw new RangeError("Index out of valid range");return t},contains:function(t){return this._valueCounts.has(t)},indexOf:function(t,e){return this._items.indexOf(t,this._validateIndex(e))},lastIndexOf:function(t,e){return this._items.lastIndexOf(t,void 0===e?-1:this._validateIndex(e))},get:function(t){return this._items[this._validateIndex(t)]},getRange:function(t,e){t=this._validateIndex(t,!0);var n=this._items;if(void 0===e)return n.slice(t);if(t+e>n.length)throw new RangeError('Sum of "index" and "count" out of valid range');return n.slice(t,t+e)},set:function(t,e){if(this.sorted)throw new TypeError("Cannot set to sorted list");t=this._validateIndex(t);var n=this._items;return o(n[t],e)?this:(this._unregisterValue(n[t]),n[t]=e,this._registerValue(e),this.emit("change"),this)},setRange:function(t,e){if(this.sorted)throw new TypeError("Cannot set to sorted list");t=this._validateIndex(t);var n=e.length;if(!n)return this;if(t+n>this.length)throw new RangeError('Sum of "index" and "items.length" out of valid range');for(var i=this._items,r=!1,s=t+n;s>t;){var l=e[--s-t];o(i[s],l)||(this._unregisterValue(i[s]),i[s]=l,this._registerValue(l),r=!0)}return r&&this.emit("change"),this},add:function(t){return this.addRange([t]),this},addRange:function(t){return t.length?(r(this,t),this.emit("change"),this):this},insert:function(t,e){return this.insertRange(t,[e]),this},insertRange:function(t,e){if(this.sorted)throw new TypeError("Cannot insert to sorted list");t=this._validateIndex(t,!0);var n=e.length;if(!n)return this;h.apply(this._items,[t,0].concat(e));for(var i=n;i;)this._registerValue(e[--i]);return this.length+=n,this.emit("change"),this},remove:function(t,e){var n=this._items.indexOf(t,this._validateIndex(e));return-1==n?!1:(this._items.splice(n,1),this._unregisterValue(t),this.length--,this.emit("change"),!0)},removeAll:function(t,e){for(var n=this._items,i=this._validateIndex(e),r=!1;-1!=(i=n.indexOf(t,i));)n.splice(i,1),this._unregisterValue(t),r=!0;return r?(this.length=n.length,this.emit("change"),!0):!1},removeAt:function(t){var e=this._items.splice(this._validateIndex(t),1)[0];return this._unregisterValue(e),this.length--,this.emit("change"),e},removeRange:function(t,e){t=this._validateIndex(t,!0);var n=this._items;if(void 0===e)e=n.length-t;else if(t+e>n.length)throw new RangeError('Sum of "index" and "count" out of valid range');if(!e)return[];for(var i=t+e;i>t;)this._unregisterValue(n[--i]);var r=n.splice(t,e);return this.length-=e,this.emit("change"),r},clear:function(){return this.length&&(this.adoptsItemChanges&&this._valueCounts.forEach(function(t){t instanceof l&&t.off("change",this._onItemChange,this)},this),this._items.length=0,this._valueCounts.clear(),this.length=0,this.emit("change")),this},join:function(t){return this._items.join(t)},forEach:null,map:null,filter:null,find:function(t,e){e=arguments.length>=2?e:c;for(var n=this._items,i=0,r=n.length;r>i;i++){var s=n[i];if(t.call(e,s,i,this))return s}},findIndex:function(t,e){e=arguments.length>=2?e:c;for(var n=this._items,i=0,r=n.length;r>i;i++){var s=n[i];if(t.call(e,s,i,this))return i}return-1},every:null,some:null,reduce:null,reduceRight:null,clone:function(){return new this.constructor(this,{adoptsItemChanges:this.adoptsItemChanges,comparator:this.comparator,sorted:this.sorted})},toArray:function(){return this._items.slice()},toString:function(){return this._items.join()}});["forEach","map","filter","every","some"].forEach(function(t){f.prototype[t]=function(e,n){return n=arguments.length>=2?n:c,this._items[t](function(t,i){return e.call(n,t,i,this)},this)}}),["reduce","reduceRight"].forEach(function(t){f.prototype[t]=function(e,n){function i(t,n,i){return e(t,n,i,r)}var r=this,s=this._items;return arguments.length>=2?s[t](i,n):s[t](i)}}),[["keys",function(t){return t}],["values",function(t,e){return e}],["entries",function(t,e){return[t,e]}]].forEach(function(t){var e=t[1];f.prototype[t[0]]=function(){var t=this._items,n=0,i=!1;return{next:function(){if(!i){if(n<t.length)return{value:e(n,t[n++]),done:!1};i=!0}return{value:void 0,done:!0}}}}}),f.prototype[s.iterator]=f.prototype.values,t.exports=f},function(t,e,n){var i=n(5),r=n(1),s=n(7),o=n(2),l=n(10),a=Object.prototype.hasOwnProperty,u=Array.isArray,h=Function("return this;")(),c=o.extend({Implements:[l],constructor:function f(t,e){if(o.call(this),l.call(this),this._entries=new i,
this.size=0,this.adoptsItemChanges=!e||e.adoptsItemChanges!==!1,t){var n=this._entries;if(t instanceof f||t instanceof i)t._entries.forEach(function(t,e){n.set(e,t),this._registerValue(t)},this);else if(u(t))for(var r=0,s=t.length;s>r;r++){var h=t[r];n.set(h[0],h[1]),this._registerValue(h[1])}else for(var c in t)a.call(t,c)&&(n.set(c,t[c]),this._registerValue(t[c]));this.size=n.size}},has:function(t){return this._entries.has(t)},contains:function(t){return this._valueCounts.has(t)},get:function(t){return this._entries.get(t)},set:function(t,e){var n,i=this._entries,r=i.has(t);if(r){if(n=i.get(t),s(n,e))return this;this._unregisterValue(n)}return i.set(t,e),this._registerValue(e),r||this.size++,this.emit({type:"change",subtype:r?"update":"add",key:t,oldValue:n,value:e}),this},"delete":function(t){var e=this._entries;if(!e.has(t))return!1;var n=e.get(t);return e["delete"](t),this._unregisterValue(n),this.size--,this.emit({type:"change",subtype:"delete",key:t,oldValue:n,value:void 0}),!0},clear:function(){return this.size?(this.adoptsItemChanges&&this._valueCounts.forEach(function(t){t instanceof o&&t.off("change",this._onItemChange,this)},this),this._entries.clear(),this._valueCounts.clear(),this.size=0,this.emit({type:"change",subtype:"clear"}),this):this},forEach:function(t,e){e=arguments.length>=2?e:h,this._entries.forEach(function(n,i){t.call(e,n,i,this)},this)},keys:function(){return this._entries.keys()},values:function(){return this._entries.values()},entries:function(){return this._entries.entries()},clone:function(){return new this.constructor(this,{adoptsItemChanges:this.adoptsItemChanges})}});c.prototype[r.iterator]=c.prototype.entries,t.exports=c},function(t,e){function n(){}function i(){var t=s.console;(t&&t.error||n).call(t||s,r.call(arguments,function(t){return t===Object(t)&&t.stack||t}).join(" "))}var r=Array.prototype.map,s=Function("return this;")();t.exports=i},function(t,e,n){"use strict";function i(t){return t.attributes}function r(t){return t.getAttribute("key")||void 0}function s(t,e){return t.tagName==e.tagName}function o(t,e,n){function o(t,e){var n=_(t);if(n){var i=w[n];i?(delete w[n],i.el.parentNode.replaceChild(t,i.el),c(t,i.toEl,!1)):(x[n]=C[n]=t,j=!0,e&&t.parentNode.removeChild(t))}else{e&&t.parentNode.removeChild(t);for(var r=t.firstElementChild;r;r=r.nextElementSibling)o(r,!1);b&&b(t)}}function u(t){for(var e=t.firstElementChild,n=void 0;e;e=n){n=e.nextElementSibling;var i=_(e);if(i){var r=w[i];r?(delete w[i],r.el.parentNode.replaceChild(e,r.el),c(e,r.toEl,!1)):(x[i]=C[i]=e,j=!0)}else u(e)}}function h(t){for(var e=t.firstElementChild;e;e=e.nextElementSibling)h(e);b&&b(t)}function c(t,e,n){if(!n){if(m&&m(t,e)===!1)return;if(a(t,e,p(t)),y&&y(t,e)===!1)return}var i=t.tagName;if("TEXTAREA"!=i){for(var r=t.firstChild,s=e.firstChild;s;s=s.nextSibling){var u=s.nodeType,h=void 0;if(1==u&&(h=_(s))){var f=x[h];if(f){delete x[h],delete C[h],r===f?r=r.nextSibling:t.insertBefore(f,r||null),c(f,s,!1);continue}}for(var v=!1,d=r;d;d=d.nextSibling)if(d.nodeType==u&&(1==u?_(d)!==h||void 0===h&&!g(d,s)||(v=!0,c(d,s,!1)):(v=!0,d.nodeValue=s.nodeValue)),v){r==d?r=r.nextSibling:t.insertBefore(d,r);break}if(!v)switch(u){case 1:var b=document.createElement(s.tagName);t.insertBefore(b,r||null),h?(w[h]={el:b,toEl:s},I=!0):c(b,s,!1);break;case 3:t.insertBefore(document.createTextNode(s.nodeValue),r||null);break;case 8:t.insertBefore(document.createComment(s.nodeValue),r||null);break;default:throw new TypeError("Unsupported node type")}}for(var d=void 0;r;r=d)d=r.nextSibling,1==r.nodeType?o(r,!0):t.removeChild(r)}var E=l[i];E&&E(t,e)}n||(n={});var f,v,d=!!n.contentOnly,p=n.getElementAttributes||i,_=n.getElementKey||r,g=n.isCompatibleElements||s,m=n.onBeforeMorphElement,y=n.onBeforeMorphElementContent,b=n.onElementRemoved,E=document.activeElement;void 0!==E.selectionStart&&(f=E.scrollLeft,v=E.scrollTop);var x=Object.create(null),C=Object.create(null),w=Object.create(null),j=!1,I=!1;for(c(t,e,d);I;){for(;j;){j=!1;for(var O in C){var S=C[O];delete C[O],u(S)}}I=!1;for(var O in w){var T=w[O];if(delete w[O],c(T.el,T.toEl,!1),I)break}}for(var O in x)h(x[O]);E!=document.activeElement&&(void 0!==f&&(E.scrollLeft=f,E.scrollTop=v),E.focus())}var l=n(27),a=n(26);t.exports=o},function(t,e){"use strict";function n(t,e,n){for(var i=e.attributes,r=i.length;r;){var s=i.item(--r),o=n.getNamedItem(s.name);o&&o.value==s.value||t.setAttribute(s.name,s.value)}for(var r=n.length;r;){var o=n.item(--r);i.getNamedItem(o.name)||t.removeAttribute(o.name)}}t.exports=n},function(t,e){"use strict";var n={INPUT:function(t,e){t.value!=e.value&&(t.value=e.value),t.checked=e.checked},TEXTAREA:function(t,e){var n=e.value;t.value!=n&&(t.value=n),t.firstChild&&(t.firstChild.nodeValue=n)},OPTION:function(t,e){t.selected=e.selected}};t.exports=n}])});